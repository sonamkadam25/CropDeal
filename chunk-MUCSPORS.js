import{a as w}from"./chunk-TRTS6MU6.js";import{a as M,b as i,c as S,d as E,f as F,g as N,h as I,i as O,m as D,o as k}from"./chunk-MDTR3QT2.js";import{a as v,b as _}from"./chunk-VARBTXGR.js";import{Ea as g,Hb as y,Ia as C,Kb as P,Pa as c,Sa as o,Ta as e,Ua as a,Ya as b,Za as x,db as r,eb as h,va as m,za as f}from"./chunk-LATPFVPJ.js";function G(l,s){if(l&1&&a(0,"app-notification",10),l&2){let t=x();c("crop",t.postedCrop.crop)("notifiedDealers",t.postedCrop.notifiedDealers)}}var R=class l{constructor(s,t){this.fb=s;this.http=t;this.cropForm=this.fb.group({type:["",i.required],name:["",i.required],quantity:[null,[i.required,i.min(1)]],pricePerUnit:[null,[i.required,i.min(1)]],location:["",i.required]})}cropForm;message="";postedCrop=null;crops=[];errorMessage="";ngOnInit(){}onSubmit(){if(this.cropForm.invalid){this.message="Please fill all fields correctly.";return}let s=localStorage.getItem("token"),t=localStorage.getItem("email"),p=new v({Authorization:`Bearer ${s}`});this.http.get("http://localhost:8000/FARMERSERVICE/farmers/crops/all",{headers:p}).subscribe({next:n=>{if(this.crops=n.filter(u=>u.farmer.email===t),this.crops.length>0){let u=this.crops[0].farmer.id;localStorage.setItem("farmerid",u)}else this.errorMessage="No crops found for your account."},error:n=>{this.errorMessage="Failed to fetch crops.",console.error(n)}});let d=localStorage.getItem("farmerid");if(!d||!s){this.message="Authorization failed. Please login again.";return}let q=`http://localhost:8000/FARMERSERVICE/farmers/crops/${d}/post`,A=this.cropForm.value;this.http.post(q,A,{headers:p}).subscribe({next:n=>{this.message="Crop posted successfully!",this.postedCrop=n,console.log("Response of crop posted",n),this.cropForm.reset()},error:n=>{this.message="Failed to post crop.",console.error(n)}})}static \u0275fac=function(t){return new(t||l)(f(D),f(_))};static \u0275cmp=g({type:l,selectors:[["app-post-crop"]],decls:29,vars:3,consts:[[1,"post-crop-container"],[3,"ngSubmit","formGroup"],["type","text","formControlName","type","placeholder","vegetable or fruit"],["type","text","formControlName","name"],["type","number","formControlName","quantity"],["type","number","formControlName","pricePerUnit"],["type","text","formControlName","location"],["type","submit"],[1,"message"],[3,"crop","notifiedDealers",4,"ngIf"],[3,"crop","notifiedDealers"]],template:function(t,p){t&1&&(o(0,"div",0)(1,"h2"),r(2,"Post New Crop"),e(),o(3,"form",1),b("ngSubmit",function(){return p.onSubmit()}),o(4,"div")(5,"label"),r(6,"Type:"),e(),a(7,"input",2),e(),o(8,"div")(9,"label"),r(10,"Name:"),e(),a(11,"input",3),e(),o(12,"div")(13,"label"),r(14,"Quantity (kg):"),e(),a(15,"input",4),e(),o(16,"div")(17,"label"),r(18,"Price (kg):"),e(),a(19,"input",5),e(),o(20,"div")(21,"label"),r(22,"Location:"),e(),a(23,"input",6),e(),o(24,"button",7),r(25,"Post Crop"),e()(),o(26,"p",8),r(27),e(),C(28,G,1,2,"app-notification",9),e()),t&2&&(m(3),c("formGroup",p.cropForm),m(24),h(p.message),m(),c("ngIf",p.postedCrop))},dependencies:[P,y,k,F,M,N,S,E,I,O,w],styles:[".post-crop-container[_ngcontent-%COMP%]{max-width:500px;margin:80px auto;padding:25px;border:1px solid #ccc;border-radius:12px;background-color:#f9f9f9;box-shadow:0 4px 8px #0000001a}.post-crop-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px;color:#2c3e50}form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:15px;display:flex;flex-direction:column}label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:5px;color:#34495e}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-radius:6px;font-size:16px}input[type=text][_ngcontent-%COMP%]:focus, input[type=number][_ngcontent-%COMP%]:focus{border-color:#3498db;outline:none;background-color:#eef9ff}button[type=submit][_ngcontent-%COMP%]{width:100%;padding:12px;background-color:#2ecc71;border:none;border-radius:6px;font-size:16px;font-weight:700;color:#fff;cursor:pointer;transition:background-color .3s ease}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#27ae60}.message[_ngcontent-%COMP%]{text-align:center;margin-top:20px;font-weight:500;color:#2980b9}"]})};export{R as PostCropComponent};
