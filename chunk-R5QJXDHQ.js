import{a as R,b as w}from"./chunk-VARBTXGR.js";import{Ea as u,Gb as O,Hb as h,Ia as _,Jb as P,Kb as E,Pa as l,Sa as a,Ta as n,Xa as C,Y as g,Ya as v,Z as f,Za as m,db as i,eb as b,fb as s,kb as I,mb as M,va as r,za as x}from"./chunk-LATPFVPJ.js";function S(o,t){o&1&&(a(0,"div",5),i(1,"Loading receipts..."),n())}function N(o,t){if(o&1&&(a(0,"div",6),i(1),n()),o&2){let e=m();r(),b(e.errorMessage)}}function k(o,t){o&1&&(a(0,"div",7),i(1," No receipts found. "),n())}function D(o,t){if(o&1){let e=C();a(0,"div",8)(1,"p")(2,"strong"),i(3,"Receipt ID:"),n(),i(4),n(),a(5,"p")(6,"strong"),i(7,"Farmer Name:"),n(),i(8),n(),a(9,"p")(10,"strong"),i(11,"Amount Paid:"),n(),i(12),n(),a(13,"p")(14,"strong"),i(15,"Crop Name:"),n(),i(16),n(),a(17,"p")(18,"strong"),i(19,"Date:"),n(),i(20),I(21,"date"),n(),a(22,"button",9),v("click",function(){let p=g(e).$implicit,d=m();return f(d.downloadReceipt(p))}),i(23,"Download"),n()()}if(o&2){let e=t.$implicit;r(4),s(" ",e.id,""),r(4),s(" ",e.farmerName,""),r(4),s(" \u20B9",e.amount,""),r(4),s(" ",e.cropName,""),r(4),s(" ",M(21,5,e.date,"medium"),"")}}var y=class o{constructor(t){this.http=t}receipts=[];loading=!0;errorMessage="";downloadReceipt(t){let e=`
Receipt ID: ${t.id}
Farmer Name: ${t.farmerName}
Amount Paid: \u20B9${t.amount/100}
Crop Name: ${t.cropName}
Date: ${new Date(t.date).toLocaleString()}
`,c=new Blob([e],{type:"text/plain"}),p=window.URL.createObjectURL(c),d=document.createElement("a");d.href=p,d.download=`receipt-${t.id}.txt`,d.click(),window.URL.revokeObjectURL(p)}ngOnInit(){let t=localStorage.getItem("token"),e=localStorage.getItem("farmerId");if(!t||!e){this.errorMessage="Unauthorized or farmer not found!",this.loading=!1;return}let c=new R({Authorization:`Bearer ${t}`});this.http.get(`http://localhost:8000/PAYMENTSERVICE/payment/receipt/${e}`,{headers:c}).subscribe({next:p=>{this.receipts=Array.isArray(p)?p:[p],this.loading=!1},error:p=>{this.errorMessage=p.error?.message||"Failed to load receipts.",this.loading=!1}})}static \u0275fac=function(e){return new(e||o)(x(w))};static \u0275cmp=u({type:o,selectors:[["app-receipts"]],decls:7,vars:4,consts:[[1,"receipts-container"],["class","loading-text",4,"ngIf"],["class","error-text",4,"ngIf"],["class","no-receipts",4,"ngIf"],["class","receipt-card",4,"ngFor","ngForOf"],[1,"loading-text"],[1,"error-text"],[1,"no-receipts"],[1,"receipt-card"],[3,"click"]],template:function(e,c){e&1&&(a(0,"div",0)(1,"h2"),i(2,"Payment Receipts"),n(),_(3,S,2,0,"div",1)(4,N,2,1,"div",2)(5,k,2,0,"div",3)(6,D,24,8,"div",4),n()),e&2&&(r(3),l("ngIf",c.loading),r(),l("ngIf",c.errorMessage),r(),l("ngIf",!c.loading&&c.receipts.length===0),r(),l("ngForOf",c.receipts))},dependencies:[E,O,h,P],styles:[".receipts-container[_ngcontent-%COMP%]{max-width:700px;margin:100px auto;padding:25px;background:#fefefe;border-radius:12px;box-shadow:0 10px 25px #0000001a;font-family:Segoe UI,sans-serif}.receipts-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:#2c3e50;margin-bottom:30px}.receipt-card[_ngcontent-%COMP%]{background:#f9f9f9;border:1px solid #ddd;padding:20px;margin-bottom:15px;border-radius:8px;transition:.3s}.receipt-card[_ngcontent-%COMP%]:hover{background-color:#f1f9ff;border-color:#bcdfff}.receipt-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;color:#34495e;font-size:15px}.loading-text[_ngcontent-%COMP%], .error-text[_ngcontent-%COMP%], .no-receipts[_ngcontent-%COMP%]{text-align:center;margin-top:20px;font-size:16px}.error-text[_ngcontent-%COMP%]{color:#e74c3c}.no-receipts[_ngcontent-%COMP%]{color:#7f8c8d}.receipt-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:10px;padding:8px 12px;font-size:14px;color:#fff;background-color:#2ecc71;border:none;border-radius:6px;cursor:pointer;transition:background-color .2s ease}.receipt-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#27ae60}"]})};export{y as ReceiptsComponent};
