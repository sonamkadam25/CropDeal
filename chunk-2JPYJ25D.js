import{a as B,c as F,e as L,j,k as H,l as R,n as U}from"./chunk-MDTR3QT2.js";import{b as z}from"./chunk-VARBTXGR.js";import{Ea as y,Gb as N,Hb as W,Ia as C,Kb as A,Pa as _,Qa as I,Sa as t,Ta as n,Va as O,Wa as P,Xa as M,Y as p,Ya as h,Z as m,Za as c,_a as D,a as S,cb as V,db as a,eb as g,fb as k,gb as x,hb as f,ib as u,nb as T,sa as v,va as r,za as w}from"./chunk-LATPFVPJ.js";function K(l,d){if(l&1&&(t(0,"div",5),a(1),n()),l&2){let e=c();r(),g(e.errorMessage)}}function Q(l,d){if(l&1){let e=M();O(0),t(1,"td"),a(2),n(),t(3,"td")(4,"input",9),u("ngModelChange",function(i){p(e);let s=c(3);return f(s.editedDealer.name,i)||(s.editedDealer.name=i),m(i)}),n()(),t(5,"td")(6,"input",9),u("ngModelChange",function(i){p(e);let s=c(3);return f(s.editedDealer.email,i)||(s.editedDealer.email=i),m(i)}),n()(),t(7,"td")(8,"input",9),u("ngModelChange",function(i){p(e);let s=c(3);return f(s.editedDealer.phone,i)||(s.editedDealer.phone=i),m(i)}),n()(),t(9,"td")(10,"select",9),u("ngModelChange",function(i){p(e);let s=c(3);return f(s.editedDealer.active,i)||(s.editedDealer.active=i),m(i)}),t(11,"option",10),a(12,"Active"),n(),t(13,"option",10),a(14,"Inactive"),n()()(),t(15,"td")(16,"button",11),h("click",function(){p(e);let i=c(3);return m(i.saveEdit())}),a(17,"Save"),n(),t(18,"button",11),h("click",function(){p(e);let i=c(3);return m(i.cancelEdit())}),a(19,"Cancel"),n()(),P()}if(l&2){let e=c().$implicit,o=c(2);r(2),g(e.id),r(2),x("ngModel",o.editedDealer.name),r(2),x("ngModel",o.editedDealer.email),r(2),x("ngModel",o.editedDealer.phone),r(2),x("ngModel",o.editedDealer.active),r(),_("value",!0),r(2),_("value",!1)}}function X(l,d){if(l&1){let e=M();t(0,"td"),a(1),n(),t(2,"td"),a(3),n(),t(4,"td")(5,"a",12),a(6),n()(),t(7,"td")(8,"a",12),a(9),n()(),t(10,"td")(11,"span"),a(12),n()(),t(13,"td")(14,"button",11),h("click",function(){p(e);let i=c().$implicit,s=c(2);return m(s.startEdit(i))}),a(15,"Edit"),n()()}if(l&2){let e=c().$implicit;r(),g(e.id),r(2),g(e.name),r(2),D("href","mailto:",e.email,"",v),r(),g(e.email),r(2),D("href","tel:",e.phone,"",v),r(),g(e.phone),r(2),I("active",e.active)("inactive",!e.active),r(),k(" ",e.active?"Active":"Inactive"," ")}}function Y(l,d){if(l&1&&(t(0,"tr"),C(1,Q,20,7,"ng-container",8)(2,X,16,13,"ng-template",null,0,T),n()),l&2){let e=d.$implicit,o=V(3),i=c(2);r(),_("ngIf",i.editDealerId===e.id)("ngIfElse",o)}}function Z(l,d){if(l&1&&(t(0,"table",6)(1,"thead")(2,"tr")(3,"th"),a(4,"ID"),n(),t(5,"th"),a(6,"Name"),n(),t(7,"th"),a(8,"Email"),n(),t(9,"th"),a(10,"Phone"),n(),t(11,"th"),a(12,"Status"),n(),t(13,"th"),a(14,"Edit"),n()()(),t(15,"tbody"),C(16,Y,4,2,"tr",7),n()()),l&2){let e=c();r(16),_("ngForOf",e.dealers)}}function ee(l,d){l&1&&(t(0,"div",13),a(1," No dealers found. "),n())}var G=class l{constructor(d){this.http=d}dealers=[];errorMessage="";editDealerId=null;editedDealer={};ngOnInit(){this.getAllDealers()}getAllDealers(){let d=localStorage.getItem("token");if(!d){this.errorMessage="No auth token found. Please login again.";return}this.http.get("http://localhost:8000/ADMINSERVICE/admin/dealers",{headers:{Authorization:`Bearer ${d}`}}).subscribe({next:e=>this.dealers=e,error:e=>{console.error("Error fetching dealers:",e),this.errorMessage="Failed to load dealers."}})}startEdit(d){this.editDealerId=d.id,this.editedDealer=S({},d)}cancelEdit(){this.editDealerId=null,this.editedDealer={}}saveEdit(){let d=localStorage.getItem("token");if(!d||!this.editedDealer.id)return;let{id:e,name:o,email:i,phone:s,password:$,active:q}=this.editedDealer,J={name:o,email:i,phone:s,password:$||"123"},E={Authorization:`Bearer ${d}`,"Content-Type":"application/json"};this.http.put(`http://localhost:8000/admin/dealer/${e}/update`,J,{headers:E}).subscribe({next:()=>{this.http.put(`http://localhost:8000/ADMINSERVICE/admin/dealer/${e}/status?active=${q}`,{},{headers:E,responseType:"text"}).subscribe({next:()=>{this.getAllDealers(),this.cancelEdit()},error:b=>{console.error("Dealer status update failed",b),alert("Dealer status update failed.")}})},error:b=>{console.error("Dealer profile update failed",b),alert("Dealer profile update failed.")}})}static \u0275fac=function(e){return new(e||l)(w(z))};static \u0275cmp=y({type:l,selectors:[["app-dealers"]],decls:6,vars:3,consts:[["viewMode",""],[1,"dealers-container"],["class","error-message",4,"ngIf"],["class","dealers-table",4,"ngIf"],["class","no-dealers",4,"ngIf"],[1,"error-message"],[1,"dealers-table"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[3,"ngModelChange","ngModel"],[3,"value"],[3,"click"],[3,"href"],[1,"no-dealers"]],template:function(e,o){e&1&&(t(0,"div",1)(1,"h2"),a(2,"Dealers List"),n(),C(3,K,2,1,"div",2)(4,Z,17,1,"table",3)(5,ee,2,0,"div",4),n()),e&2&&(r(3),_("ngIf",o.errorMessage),r(),_("ngIf",o.dealers.length>0),r(),_("ngIf",o.dealers.length===0&&!o.errorMessage))},dependencies:[A,N,W,U,H,R,B,j,F,L],styles:[".dealers-container[_ngcontent-%COMP%]{max-width:1000px;margin:30px auto;padding:20px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px;font-size:2rem;color:#2c3e50}.error-message[_ngcontent-%COMP%]{color:#e74c3c;font-weight:600;text-align:center;margin-bottom:20px}.no-dealers[_ngcontent-%COMP%]{text-align:center;font-style:italic;color:#7f8c8d;margin-top:30px}.dealers-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;box-shadow:0 0 10px #0000001a}.dealers-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .dealers-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:12px 16px;text-align:left}.dealers-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:600;color:#34495e}.dealers-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#fafafa}.dealers-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}a[_ngcontent-%COMP%]{color:#2980b9;text-decoration:none}a[_ngcontent-%COMP%]:hover{text-decoration:underline}.active[_ngcontent-%COMP%]{color:green;font-weight:700}.inactive[_ngcontent-%COMP%]{color:red;font-weight:700}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:4px;width:100%;box-sizing:border-box}button[_ngcontent-%COMP%]{margin:0 2px;padding:6px 10px;cursor:pointer;border:none;background-color:#3498db;color:#fff;border-radius:4px;font-size:.9rem}button[_ngcontent-%COMP%]:hover{background-color:#2980b9}"]})};export{G as DealersComponent};
