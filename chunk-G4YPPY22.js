import{a as I,c as M,d as y,f as F,h as w,i as N,j as O,k as B,l as D,m as V,o as T}from"./chunk-MDTR3QT2.js";import{a as _,b as P}from"./chunk-VARBTXGR.js";import{Ea as v,Fb as S,Hb as E,Ia as h,Kb as k,Pa as m,Sa as n,Ta as t,Ua as d,Xa as x,Y as p,Ya as u,Z as f,Za as c,db as i,eb as g,fb as C,va as s,za as b}from"./chunk-LATPFVPJ.js";function R(o,r){if(o&1){let e=x();n(0,"form",7),u("ngSubmit",function(){p(e);let l=c(2);return f(l.saveProfile())}),n(1,"h2"),i(2,"Edit Dealer Profile"),t(),n(3,"div",8)(4,"label"),i(5,"Name"),t(),d(6,"input",9),t(),n(7,"div",8)(8,"label"),i(9,"Email"),t(),d(10,"input",10),t(),n(11,"div",8)(12,"label"),i(13,"Phone"),t(),d(14,"input",11),t(),n(15,"div",8)(16,"label"),i(17,"Status"),t(),n(18,"select",12)(19,"option",13),i(20,"Active"),t(),n(21,"option",13),i(22,"Inactive"),t()()(),n(23,"button",14),i(24,"Save Profile"),t()()}if(o&2){let e=c(2);m("formGroup",e.profileForm),s(19),m("value",!0),s(2),m("value",!1)}}function $(o,r){if(o&1&&(n(0,"div",15)(1,"h2"),i(2,"Dealer Profile"),t(),n(3,"div",8)(4,"label"),i(5,"Dealer ID"),t(),n(6,"span"),i(7),t()(),n(8,"div",8)(9,"label"),i(10,"Name"),t(),n(11,"span"),i(12),t()(),n(13,"div",8)(14,"label"),i(15,"Email"),t(),n(16,"span"),i(17),t()(),n(18,"div",8)(19,"label"),i(20,"Phone"),t(),n(21,"span"),i(22),t()(),n(23,"div",8)(24,"label"),i(25,"Status"),t(),n(26,"span",16),i(27),t()()()),o&2){let e=c(2);s(7),g(e.dealer.id),s(5),g(e.dealer.name),s(5),g(e.dealer.email),s(5),g(e.dealer.phone),s(4),m("ngClass",e.dealer.active?"status-active":"status-inactive"),s(),C(" ",e.dealer.active?"Active":"Inactive"," ")}}function j(o,r){if(o&1){let e=x();n(0,"div",2),h(1,R,25,3,"form",3)(2,$,28,6,"div",4),n(3,"div",5)(4,"button",6),u("click",function(){p(e);let l=c();return f(l.enableEdit())}),i(5,"Update Profile"),t(),n(6,"button",6),u("click",function(){p(e);let l=c();return f(l.toggleBankForm())}),i(7,"Add Bank Details"),t()()()}if(o&2){let e=c();s(),m("ngIf",e.updateMode),s(),m("ngIf",!e.updateMode)}}function H(o,r){if(o&1){let e=x();n(0,"div",2)(1,"form",7),u("ngSubmit",function(){p(e);let l=c();return f(l.submitBankDetails())}),n(2,"h2"),i(3,"Bank Details"),t(),n(4,"div",8)(5,"label"),i(6,"Account Number"),t(),d(7,"input",17),t(),n(8,"div",8)(9,"label"),i(10,"IFSC Code"),t(),d(11,"input",18),t(),n(12,"div",8)(13,"label"),i(14,"Bank Name"),t(),d(15,"input",19),t(),n(16,"div",5)(17,"button",14),i(18,"Save Bank Details"),t(),n(19,"button",20),u("click",function(){p(e);let l=c();return f(l.toggleBankForm())}),i(20,"Cancel"),t()()()()}if(o&2){let e=c();s(),m("formGroup",e.bankForm)}}function z(o,r){if(o&1&&(n(0,"p",21),i(1),t()),o&2){let e=c();s(),g(e.errorMessage)}}var A=class o{constructor(r,e){this.http=r;this.fb=e}dealer=null;errorMessage="";updateMode=!1;showBankForm=!1;profileForm;bankForm;ngOnInit(){let r=localStorage.getItem("token"),e=localStorage.getItem("email");if(!r||!e){this.errorMessage="No auth token or email found. Please login again.";return}let a=new _({Authorization:`Bearer ${r}`});this.http.get(`http://localhost:8000/DEALERSERVICE/dealer/email/${e}`,{headers:a}).subscribe({next:l=>{this.http.get(`http://localhost:8000/DEALERSERVICE/dealer/${l}`,{headers:a}).subscribe({next:G=>{this.dealer=G,localStorage.setItem("dealerId",this.dealer.id),this.initProfileForm(),this.initBankForm()},error:()=>this.errorMessage="Failed to load dealer profile."})},error:()=>this.errorMessage="Failed to fetch dealer ID."})}initProfileForm(){this.profileForm=this.fb.group({id:[this.dealer.id],name:[this.dealer.name],email:[this.dealer.email],phone:[this.dealer.phone],active:[this.dealer.active]})}initBankForm(){this.bankForm=this.fb.group({accountNumber:[""],ifsc:[""],bankName:[""]})}enableEdit(){this.updateMode=!0}saveProfile(){let r=localStorage.getItem("token"),e=localStorage.getItem("dealerId");if(!r||!e){this.errorMessage="Missing authentication details.";return}let a=new _({Authorization:`Bearer ${r}`,"Content-Type":"application/json"});this.http.put(`http://localhost:8000/DEALERSERVICE/dealer/update/${e}`,this.profileForm.value,{headers:a}).subscribe({next:l=>{this.dealer=l,this.updateMode=!1,alert("Dealer profile updated successfully!")},error:()=>this.errorMessage="Failed to update dealer profile."})}toggleBankForm(){this.showBankForm=!this.showBankForm}submitBankDetails(){let r=localStorage.getItem("token"),e=localStorage.getItem("dealerId");if(!r||!e){this.errorMessage="Missing authentication details.";return}let a=new _({Authorization:`Bearer ${r}`,"Content-Type":"application/json"});this.http.post(`http://localhost:8000/DEALERSERVICE/dealer/bank/${e}`,this.bankForm.value,{headers:a,responseType:"text"}).subscribe({next:l=>{alert(l),this.showBankForm=!1,this.bankForm.reset()},error:()=>this.errorMessage="Failed to add bank details."})}static \u0275fac=function(e){return new(e||o)(b(P),b(V))};static \u0275cmp=v({type:o,selectors:[["app-profile"]],decls:3,vars:3,consts:[["class","profile-container",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"profile-container"],["class","profile-card",3,"formGroup","ngSubmit",4,"ngIf"],["class","profile-card",4,"ngIf"],[1,"button-group"],[3,"click"],[1,"profile-card",3,"ngSubmit","formGroup"],[1,"profile-field"],["type","text","formControlName","name"],["type","email","formControlName","email"],["type","text","formControlName","phone"],["formControlName","active"],[3,"value"],["type","submit"],[1,"profile-card"],[3,"ngClass"],["type","text","formControlName","accountNumber"],["type","text","formControlName","ifsc"],["type","text","formControlName","bankName"],["type","button",3,"click"],[1,"error-message"]],template:function(e,a){e&1&&h(0,j,8,2,"div",0)(1,H,21,1,"div",0)(2,z,2,1,"p",1),e&2&&(m("ngIf",a.dealer),s(),m("ngIf",a.showBankForm),s(),m("ngIf",a.errorMessage))},dependencies:[k,S,E,T,F,B,D,I,O,M,y,w,N],styles:[".profile-container[_ngcontent-%COMP%]{max-width:500px;margin:110px auto;padding:24px;background-color:#f9f9f9;border-radius:16px;box-shadow:0 4px 8px #0000001a}.profile-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.profile-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:12px;color:#2c3e50}.profile-field[_ngcontent-%COMP%]{display:flex;flex-direction:column}.profile-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#34495e;margin-bottom:6px}.profile-field[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .profile-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .profile-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;padding:8px;border:1px solid #ccc;border-radius:8px;background-color:#fff}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:20px}.status-active[_ngcontent-%COMP%]{color:green;font-weight:700}.status-inactive[_ngcontent-%COMP%]{color:red;font-weight:700}.error-message[_ngcontent-%COMP%]{color:red;text-align:center;margin-top:20px}button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#3498db;color:#fff;font-weight:700;border:none;border-radius:8px;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{background-color:#2980b9}button[type=button][_ngcontent-%COMP%]{background-color:#e74c3c}button[type=button][_ngcontent-%COMP%]:hover{background-color:#c0392b}"]})};export{A as ProfileComponent};
